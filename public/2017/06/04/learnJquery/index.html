<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="1. jQuery整体架构123456789101112131415161718192021222324//函数自执行(function(global, factory) &amp;#123;   factory(global);      &amp;#125;(typeof window !== &quot;undefined&quot; ? window : this, function(window, noGlobal) &amp;#">
<meta property="og:type" content="article">
<meta property="og:title" content="learnJquery">
<meta property="og:url" content="http://www.ceerqingting.com/2017/06/04/learnJquery/index.html">
<meta property="og:site_name" content="ceerqingting">
<meta property="og:description" content="1. jQuery整体架构123456789101112131415161718192021222324//函数自执行(function(global, factory) &amp;#123;   factory(global);      &amp;#125;(typeof window !== &quot;undefined&quot; ? window : this, function(window, noGlobal) &amp;#">
<meta property="og:image" content="http://www.ceerqingting.com/2017/06/04/learnJquery/jquery.jpg">
<meta property="og:image" content="http://www.ceerqingting.com/images/selector.jpg">
<meta property="og:image" content="http://www.ceerqingting.com/images/init.jpg">
<meta property="og:image" content="http://www.ceerqingting.com/images/prevObject.jpg">
<meta property="og:updated_time" content="2017-07-03T05:46:46.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="learnJquery">
<meta name="twitter:description" content="1. jQuery整体架构123456789101112131415161718192021222324//函数自执行(function(global, factory) &amp;#123;   factory(global);      &amp;#125;(typeof window !== &quot;undefined&quot; ? window : this, function(window, noGlobal) &amp;#">
<meta name="twitter:image" content="http://www.ceerqingting.com/2017/06/04/learnJquery/jquery.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"right","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '3SRURALB9D',
      apiKey: '53d905ca31ca983780cf021aa0ef659e',
      indexName: 'dev_BLOG',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.ceerqingting.com/2017/06/04/learnJquery/"/>





  <title> learnJquery | ceerqingting </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?37f2a3f79bab68adc77b5066ac9ab690";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container one-collumn sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ceerqingting</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-guestbook">
          <a href="/guestbook" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            留言
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://www.ceerqingting.com/2017/06/04/learnJquery/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Jiang Fen">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/uploads/avatar.png">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="ceerqingting">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="ceerqingting" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                learnJquery
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-04T15:58:36+08:00">
                2017-06-04
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/06/04/learnJquery/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/06/04/learnJquery/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/06/04/learnJquery/" class="leancloud_visitors" data-flag-title="learnJquery">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="1-jQuery整体架构"><a href="#1-jQuery整体架构" class="headerlink" title="1. jQuery整体架构"></a>1. jQuery整体架构</h1><p><img src="http://www.ceerqingting.com/2017/06/04/learnJquery/jquery.jpg" alt="img"><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//函数自执行</span></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">global, factory</span>) </span>&#123;</div><div class="line">   factory(global);</div><div class="line">      &#125;(<span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">"undefined"</span> ? <span class="built_in">window</span> : <span class="keyword">this</span>, <span class="function"><span class="keyword">function</span>(<span class="params">window, noGlobal</span>) </span>&#123;</div><div class="line">          <span class="keyword">var</span> jQuery = <span class="function"><span class="keyword">function</span>(<span class="params"> selector, context </span>) </span>&#123;</div><div class="line">          <span class="keyword">return</span> <span class="keyword">new</span> jQuery.fn.init( selector, context );</div><div class="line">        &#125;;</div><div class="line">        jQuery.fn = jQuery.prototype = &#123;&#125;;</div><div class="line">        <span class="comment">// 核心方法</span></div><div class="line">        <span class="comment">// 回调系统</span></div><div class="line">        <span class="comment">// 异步队列</span></div><div class="line">        <span class="comment">// 数据缓存</span></div><div class="line">        <span class="comment">// 队列操作</span></div><div class="line">        <span class="comment">// 选择器引</span></div><div class="line">        <span class="comment">// 属性操作</span></div><div class="line">        <span class="comment">// 节点遍历</span></div><div class="line">        <span class="comment">// 文档处理</span></div><div class="line">        <span class="comment">// 样式操作</span></div><div class="line">        <span class="comment">// 属性操作</span></div><div class="line">        <span class="comment">// 事件体系</span></div><div class="line">        <span class="comment">// AJAX交互</span></div><div class="line">        <span class="comment">// 动画引擎</span></div><div class="line">        <span class="keyword">return</span> jQuery;</div><div class="line"> &#125;));</div></pre></td></tr></table></figure></p>
<h2 id="1-五大块"><a href="#1-五大块" class="headerlink" title="1. 五大块"></a>1. 五大块</h2><ul>
<li>选择器</li>
<li>DOM操作</li>
<li>事件</li>
<li>AJAX</li>
<li>动画</li>
</ul>
<h2 id="2-示例"><a href="#2-示例" class="headerlink" title="2. 示例"></a>2. 示例</h2><ul>
<li><p>接口：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">.ajaxComplete()</div><div class="line">.ajaxError()</div><div class="line">.ajaxSend()</div><div class="line">.ajaxStart()</div><div class="line">.ajaxStop()</div><div class="line">.ajaxSuccess()</div></pre></td></tr></table></figure>
</li>
<li><p>底层接口：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">jQuery.ajax()</div><div class="line">jQuery.ajaxSetup()</div></pre></td></tr></table></figure>
</li>
<li><p>快捷方法：<br></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">jQuery.get()</div><div class="line">jQuery.getJSON()</div><div class="line">jQuery.getScript()</div><div class="line">jQuery.post()</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="3-jQuery接口设计原理"><a href="#3-jQuery接口设计原理" class="headerlink" title="3. jQuery接口设计原理"></a>3. jQuery接口设计原理</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">jQuery.each([<span class="string">"get"</span>, <span class="string">"post"</span>]), <span class="function"><span class="keyword">function</span>(<span class="params">i, method</span>)</span>&#123;</div><div class="line">  jQuery[ method ] = <span class="function"><span class="keyword">function</span>(<span class="params"> url, data, callback, type</span>) </span>&#123;</div><div class="line">    <span class="comment">//Shift arguments if data argument was omitted</span></div><div class="line">    <span class="keyword">if</span>( jQuery.isFunction( data ))&#123;</div><div class="line">      type = type || callback;</div><div class="line">      callback = dta;</div><div class="line">      data = <span class="literal">undefined</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> jQuery.ajax(&#123;</div><div class="line">      <span class="attr">url</span>: url,</div><div class="line">      <span class="attr">type</span>: method,</div><div class="line">      <span class="attr">data</span>: data,</div><div class="line">      <span class="attr">success</span>: callback</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="2-立即调用表达式"><a href="#2-立即调用表达式" class="headerlink" title="2. 立即调用表达式"></a>2. 立即调用表达式</h1><blockquote>
<p>解决命名空间与变量污染的问题<br>参考：<a href="http://www.cnblogs.com/TomXu/archive/2011/12/31/2289423.html" target="_blank" rel="external">立即调用的函数表达式</a>  </p>
</blockquote>
<h2 id="1-写法"><a href="#1-写法" class="headerlink" title="1. 写法"></a>1. 写法</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//写法一：</span></div><div class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params">window, factory</span>)</span>&#123;</div><div class="line">    factory(<span class="built_in">window</span>)</div><div class="line">  &#125;(<span class="keyword">this</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      <span class="comment">//jQuery的调用</span></div><div class="line">    &#125;</div><div class="line">  &#125;))</div><div class="line"><span class="comment">//写法二：</span></div><div class="line">  <span class="keyword">var</span> factory = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      <span class="comment">//执行方法</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">var</span> jQuery = factory();</div><div class="line"><span class="comment">//写法三：</span></div><div class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params">window, undefined</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> jQuery = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">    <span class="comment">//....</span></div><div class="line">    <span class="built_in">window</span>.jQuery = <span class="built_in">window</span>.$ = jQuery;</div><div class="line">  &#125;)(<span class="built_in">window</span>);</div></pre></td></tr></table></figure>
<h2 id="2-写法优势"><a href="#2-写法优势" class="headerlink" title="2. 写法优势"></a>2. 写法优势</h2><ul>
<li><p>window和undefined都是为了减少变量查找所经过的scope作用域。当window通过传递给闭包内部之后，在闭包内部使用它的时候，可以把它当成一个局部变量，显然比原先在window scope下查找的时候要快一些。</p>
</li>
<li><p>undefined也是同样道理，其实这个undefined并不是JavaScript数据类型的undefined，而是一个普普通通的变量名。只是因为没给它传递值，他的值就是undefined, undefined并不是JavaScript的保留字。  </p>
</li>
</ul>
<h2 id="3-为什么要传递undefined"><a href="#3-为什么要传递undefined" class="headerlink" title="3. 为什么要传递undefined"></a>3. 为什么要传递undefined</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Applications Javscript中的undefined并不是作为关键字 因此可以允许用户对其赋值  </span></div><div class="line"> <span class="keyword">var</span> <span class="literal">undefined</span> = <span class="string">"a"</span>;</div><div class="line"> (<span class="function"><span class="keyword">function</span>(<span class="params">window</span>)</span>&#123;</div><div class="line">   alert(<span class="literal">undefined</span>); <span class="comment">//IE8 "a"</span></div><div class="line"> &#125;)(<span class="built_in">window</span>)</div></pre></td></tr></table></figure>
<h2 id="4-为什么要创建一个外层包裹"><a href="#4-为什么要创建一个外层包裹" class="headerlink" title="4. 为什么要创建一个外层包裹"></a>4. 为什么要创建一个外层包裹</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">  <span class="number">1</span>、匿名函数与自执行</div><div class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      <span class="comment">//代码逻辑</span></div><div class="line">    &#125;</div><div class="line">   <span class="comment">//上面这种写法是错了，声明了它但是又不给名字又没有使用，所以在语法上错误的，那么怎么去执行一个匿名的函数呢？</span></div><div class="line">   <span class="comment">//要调用一个函数，我们必须要有方法定位它、引用它。所以，我们要取一个名字：</span></div><div class="line">   <span class="keyword">var</span> jQuery = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">     <span class="comment">//代码逻辑</span></div><div class="line">   &#125;</div><div class="line">   <span class="comment">//jQuery使用()将匿名函数括起来，然后后面再加一对小括号（包含参数列表），那么这小括号能把我们的表达式组合分块，并且每一块（也就是每一对小括号），都有一个返回值。这个返回值实际上也就是小括号中表达式的返回值。所以，当我们用一对小括号把匿名函数括起来的时候，实际上小括号返回的，就是一个匿名函数的Function对象。因此，小括号对加上匿名函数就如同有名字的函数般被我们取得它的引用位置了。所以如果在这个引用变量后面再加上参数列表，就会实现普通函数的调用形式。</span></div><div class="line"></div><div class="line"><span class="number">2</span>、jQuery在不同平台的下的加载逻辑</div><div class="line"> <span class="comment">// AMD 和 CommonJS 的支持代码</span></div><div class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="built_in">module</span> === <span class="string">"object"</span> &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">module</span>.export === <span class="string">"object"</span>)&#123;</div><div class="line">    <span class="built_in">module</span>.exports = global.document ? factory(global, <span class="literal">true</span>): <span class="function"><span class="keyword">function</span>(<span class="params">w</span>)</span>&#123;</div><div class="line">      <span class="keyword">if</span>(!w.document)&#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"jQuery requires a window with a document"</span>);</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">return</span> factory(w);</div><div class="line">    &#125;</div><div class="line">  &#125;<span class="keyword">else</span>&#123;</div><div class="line">    factory(global);</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<h2 id="5-总结"><a href="#5-总结" class="headerlink" title="5. 总结"></a>5. 总结</h2><blockquote>
<p>全局变量是魔鬼, 匿名函数可以有效的保证在页面上写入JavaScript，而不会造成全局变量的污染，通过小括号，让其加载的时候立即初始化，这样就形成了一个单例模式的效果从而只会执行一次。</p>
</blockquote>
<h1 id="3-jQuery的类数组对象结构"><a href="#3-jQuery的类数组对象结构" class="headerlink" title="3. jQuery的类数组对象结构"></a>3. jQuery的类数组对象结构</h1><h2 id="1-为什么是类数组对象呢？"><a href="#1-为什么是类数组对象呢？" class="headerlink" title="1. 为什么是类数组对象呢？"></a>1. 为什么是类数组对象呢？</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//9种方法重载</span></div><div class="line">  <span class="number">1.</span>jQuery([selector, [context]])</div><div class="line">  <span class="number">2.</span>jQuery(element)</div><div class="line">  <span class="number">3.</span>jQuery(elementArray)</div><div class="line">  <span class="number">4.</span>jQUery(object)</div><div class="line">  <span class="number">5.</span>jQuery(jQuery object)</div><div class="line">  <span class="number">6.</span>jQuery(html, [ownerDocument])</div><div class="line">  <span class="number">7.</span>jQuery(html, [attributes])</div><div class="line">  <span class="number">8.</span>jQuery()</div><div class="line">  <span class="number">9.</span>jQuery(callback)</div></pre></td></tr></table></figure>
<blockquote>
<p>9种方法整体可以分三大块： 选择器、dom的处理、dom加载<br>换句话说jQuery就是为了获取DOM、操作DOM而存在的，所以为了更方便这些操作，让节点与实例对象通过一个桥梁给关联起来，jQuery内部就采用了一种叫“类数组对象”的方法作为存储接口，所以我们既可以像对象一样处理jQuery操作，也能像数组一样可以使用push、pop、shift、unshift、sort、each、map等类数组的方法操作jQuery对象了  </p>
</blockquote>
<h2 id="2-jQuery对象可用数组下标索引是什么原理"><a href="#2-jQuery对象可用数组下标索引是什么原理" class="headerlink" title="2. jQuery对象可用数组下标索引是什么原理?"></a>2. jQuery对象可用数组下标索引是什么原理?</h2><p>通过$(“.Class”)构建的对象结构如下：<br><img src="/images/selector.jpg" alt="img"><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> aQuery = <span class="function"><span class="keyword">function</span>(<span class="params">selector</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(!(<span class="keyword">this</span> <span class="keyword">instanceof</span> aQuery))&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">new</span> aQuery(selector);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> elem = <span class="built_in">document</span>.getElementById(<span class="regexp">/[^#].*/</span>.exec(selector)[<span class="number">0</span>]);</div><div class="line">    <span class="keyword">this</span>.length = <span class="number">1</span>;</div><div class="line">    <span class="keyword">this</span>[<span class="number">0</span>] = elem;</div><div class="line">    <span class="keyword">this</span>.context = <span class="built_in">document</span>;</div><div class="line">    <span class="keyword">this</span>.selector = selector;</div><div class="line">    <span class="keyword">this</span>.get = <span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>[num];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>通过对象键值对的关系保存属性， 原型保存方法, 以上为模拟jQuery的对象结构  </p>
</blockquote>
<h2 id="3-jQuery的无new构建原理"><a href="#3-jQuery的无new构建原理" class="headerlink" title="3. jQuery的无new构建原理"></a>3. jQuery的无new构建原理</h2><blockquote>
<p>函数aQuery()内部首先保证了必须是通过new操作符构建。这样就能保证当前构建的是一个带有this的实例对象，既然是对象我们可以把所有的属性与方法作为对象的key与value的方式给映射到this上，所以如上结构就可以模拟出jQuery这样的操作了，即可通过索引取值，页也可以链式方法取值，但是缺陷是每次调用ajQuery方法等于是创建了一个新的实例，那么类似get方法就要在每一个实例上重新创建一遍，性能大打折扣，所以jQuery在结构上的优化不仅仅只是我们看到的，除了实现类数组结构、方法的原型共享，而且还实现方法的静态与实例的共存</p>
</blockquote>
<h1 id="4-jQuery中的ready与load事件"><a href="#4-jQuery中的ready与load事件" class="headerlink" title="4. jQuery中的ready与load事件"></a>4. jQuery中的ready与load事件</h1><h2 id="1-jQuery3种针对文档加载的方法"><a href="#1-jQuery3种针对文档加载的方法" class="headerlink" title="1. jQuery3种针对文档加载的方法"></a>1. jQuery3种针对文档加载的方法</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="comment">//...代码...</span></div><div class="line">&#125;)</div><div class="line"><span class="comment">//document ready简写</span></div><div class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">   <span class="comment">//...代码...</span></div><div class="line">&#125;)</div><div class="line">$(<span class="built_in">document</span>).load(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">   <span class="comment">//...代码...</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="2-ready和load区别"><a href="#2-ready和load区别" class="headerlink" title="2. ready和load区别"></a>2. ready和load区别</h2><blockquote>
<p>DOM文档加载步骤</p>
<ol>
<li>解析HTML结构</li>
<li>加载外部脚本和样式表文件</li>
<li>解析并执行脚本代码</li>
<li>构造HTML DOM模型。//ready</li>
<li>加载图片等外部文件</li>
<li>页面加载完毕 //load<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//jQuery处理文档加载时机</span></div><div class="line">jQuery.ready.promise = <span class="function"><span class="keyword">function</span>(<span class="params"> obj </span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(!readyList)&#123;</div><div class="line">    readyList = jQuery.Deferred();</div><div class="line">    <span class="keyword">if</span>(<span class="built_in">document</span>.readyState === <span class="string">'complete'</span>)&#123;</div><div class="line">      <span class="comment">//Handle it asynchronously to allow scripts the opportunity to delay ready</span></div><div class="line">      setTimeot(jQuery.ready);</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">      <span class="built_in">document</span>.addEventListener(<span class="string">"DOMContentLoaded"</span>,completed, <span class="literal">false</span>);</div><div class="line">      <span class="built_in">window</span>.addEventListner(<span class="string">"load"</span>, completed, <span class="literal">false</span>)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> readyList.promise(obj);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
</blockquote>
<h1 id="5-jQuery多库共存处理"><a href="#5-jQuery多库共存处理" class="headerlink" title="5. jQuery多库共存处理"></a>5. jQuery多库共存处理</h1><h2 id="1-使用DEMO"><a href="#1-使用DEMO" class="headerlink" title="1. 使用DEMO"></a>1. 使用DEMO</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">jQuery.noConflict();</div><div class="line"><span class="comment">//使用jQuery</span></div><div class="line">jQuery(<span class="string">"aaron"</span>).show();</div><div class="line"><span class="comment">//使用其他库的$()</span></div><div class="line">$(<span class="string">"aa"</span>).style.display = <span class="string">"block"</span>;</div><div class="line"><span class="comment">//这个函数必须在导入jQuery文件之后，并且在导入另一个导致冲突的库之前使用</span></div></pre></td></tr></table></figure>
<h2 id="2-原理"><a href="#2-原理" class="headerlink" title="2. 原理"></a>2. 原理</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> _jQuery = <span class="built_in">window</span>.jQuery, _$ = <span class="built_in">window</span>.$;</div><div class="line">jQuery.noConflict = <span class="function"><span class="keyword">function</span>(<span class="params">deep</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(<span class="built_in">window</span>.$ === jQuery)&#123;</div><div class="line">    <span class="built_in">window</span>.$ = _$;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span>(deep &amp;&amp; <span class="built_in">window</span>.jQuery === jQuery)&#123;</div><div class="line">    <span class="built_in">window</span>.jQuery = _jQuery;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> jQuery;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="6-对象的构建"><a href="#6-对象的构建" class="headerlink" title="6. 对象的构建"></a>6. 对象的构建</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//类一</span></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">ajQuery</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>.name = <span class="string">'jQuery'</span>;</div><div class="line">    <span class="keyword">this</span>.sayName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.name;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">var</span> a = <span class="keyword">new</span> ajQuery();</div><div class="line">  <span class="keyword">var</span> b = <span class="keyword">new</span> ajQuery();</div><div class="line">  <span class="keyword">var</span> c = <span class="keyword">new</span> ajQuery();</div><div class="line"></div><div class="line"><span class="comment">//类二</span></div><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">ajQuery</span>(<span class="params"></span>)</span>&#123;</div><div class="line">   <span class="keyword">this</span>.name = <span class="string">'jQuery'</span>;</div><div class="line"> &#125;  </div><div class="line"> ajQuery.prototype = &#123;</div><div class="line">   <span class="attr">sayName</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">     <span class="keyword">return</span> <span class="keyword">this</span>.name</div><div class="line">   &#125;</div><div class="line"> &#125;</div><div class="line"> <span class="keyword">var</span> a  = <span class="keyword">new</span> ajQuery();</div><div class="line"> <span class="keyword">var</span> b  = <span class="keyword">new</span> ajQuery();</div><div class="line"> <span class="keyword">var</span> c  = <span class="keyword">new</span> ajQuery();</div></pre></td></tr></table></figure>
<p>类一与类二产生的结构几乎是一样的，本质区别是：<br>类二new产生的a、b、c三个实例对象共享了原型的sayName方法，节省了内存空间，类一则是要为每一个实例复制sayName方法，每个方法属性都占用一定空间，类二则是要通过scope连接到原型链查找，无形之中要多一层作用域的查找<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//jQUery对象的构建</span></div><div class="line">jQuery = <span class="function"><span class="keyword">function</span>(<span class="params">selector, context</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> jQuery.fn.init(selector, context);</div><div class="line">&#125;</div><div class="line">jQuery.fn = jQuery.prototype = &#123;</div><div class="line">  <span class="attr">init</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">jquery</span>: version,</div><div class="line">  <span class="attr">constructor</span>: jQuery,</div><div class="line">  ....</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> a = $();</div></pre></td></tr></table></figure></p>
<p>ajQuery与jQuery结构不同点：</p>
<ol>
<li>没有采用new操作符</li>
<li>return返回的是一个通过new出来的对象</li>
</ol>
<h1 id="7-分离构造器"><a href="#7-分离构造器" class="headerlink" title="7. 分离构造器"></a>7. 分离构造器</h1><h2 id="1-通过new操作符构建一个对象："><a href="#1-通过new操作符构建一个对象：" class="headerlink" title="1. 通过new操作符构建一个对象："></a>1. 通过new操作符构建一个对象：</h2><ul>
<li>创建一个新对象</li>
<li>将构造函数的作用域赋给新对象（所以this就指向了这个新对象）</li>
<li>执行构造函数中的代码</li>
<li>返回这个新对象  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//常见类式写法</span></div><div class="line"><span class="keyword">var</span> $$ = ajQuery = <span class="function"><span class="keyword">function</span>(<span class="params">selector</span>)</span>&#123;</div><div class="line">  <span class="keyword">this</span>.selector = selector;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line">ajQuery.fn = ajQuery.prototype = &#123;</div><div class="line">  <span class="attr">selectorName</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.selector;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">construction</span>: ajQuery</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> $$(<span class="string">'aaa'</span>);</div><div class="line">a.selectorName();<span class="comment">//aaa</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>改造jQuery无new格式<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> $$ = ajQuery = <span class="function"><span class="keyword">function</span>(<span class="params">selector</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span>(!(<span class="keyword">this</span> <span class="keyword">instanceof</span> ajQuery))&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ajQuery(selector);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">this</span>.selector = selector;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>错误写法：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> $$ = ajQuery = <span class="function"><span class="keyword">function</span>(<span class="params">selecotr</span>)</span>&#123;</div><div class="line">  <span class="keyword">this</span>.selector = selector;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> ajQuery(selector);</div><div class="line">&#125;</div><div class="line"><span class="comment">//Uncaught RangeError: Maximum call stact size exceeded</span></div></pre></td></tr></table></figure></p>
<p>jQuery为了避免出现这种死循环，采取的方法为把原型上的一个init方法作为构造器<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> $$ = ajQuery = <span class="function"><span class="keyword">function</span>(<span class="params">selector</span>)</span>&#123;</div><div class="line">  <span class="comment">//把原型上的init作为构造器</span></div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> ajQuery.fn.init(selector);</div><div class="line">&#125;</div><div class="line">ajQuery.fn = ajQuery.prototype = &#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'aaron'</span>,</div><div class="line">  <span class="attr">init</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">constructor</span>: ajQuery</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>问题：init是ajQuery原型上作为构造器的一个方法，那么this就不是ajQuery了，所以this就完全引用不到ajQuery的原型了，这里通过new把init方法与ajQuery给分离成2个独立的构造器</p>
<h1 id="8-静态与实例方法共享设计"><a href="#8-静态与实例方法共享设计" class="headerlink" title="8. 静态与实例方法共享设计"></a>8. 静态与实例方法共享设计</h1><h2 id="1-遍历方法"><a href="#1-遍历方法" class="headerlink" title="1. 遍历方法"></a>1. 遍历方法</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'.aaron'</span>).each() <span class="comment">//作为实例方法存在</span></div><div class="line">$.each() <span class="comment">//作为静态方法存在</span></div></pre></td></tr></table></figure>
<p>第一条语句是给有指定的上下文调用的，就是$(‘.aaron’)获取的DOM合集，第二条语句$.each()函数可用于迭代任何集合，无论是“名/值”对象或者数组。在迭代数组的情况下，回调函数每次都会传递一个数组索引和相应的数组值作为参数，那是不是要写两个方法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//jQuery源码</span></div><div class="line">jQuery.prototype = &#123;</div><div class="line">  <span class="attr">each</span>: <span class="function"><span class="keyword">function</span>(<span class="params">callback, args</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> jQuery.each(<span class="keyword">this</span>, callback, args);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="2-共享方法"><a href="#2-共享方法" class="headerlink" title="2. 共享方法"></a>2. 共享方法</h2><blockquote>
<p>jQuery通过new原型prototype上的init方法当做构造器，那么init的原型链方法就是实例的方法，所以jQuery通过2个构造器划分2种不同的调用方式，一种是静态，一种是原型，方法是共享的<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//jQuery方案</span></div><div class="line">  ajQuery.fn = ajQuery.prototype = &#123;</div><div class="line">    <span class="attr">name</span>: <span class="string">'aaron'</span>,</div><div class="line">    <span class="attr">init</span>: <span class="function"><span class="keyword">function</span>(<span class="params">selector</span>)</span>&#123;</div><div class="line">      <span class="keyword">this</span>.selector = selector;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">constructor</span>: ajQuery</div><div class="line">  &#125;</div><div class="line">  ajQuery.fn.init.prototype = ajQuery.fn;</div></pre></td></tr></table></figure></p>
</blockquote>
<p><img src="/images/init.jpg" alt="img"><br>通过原型传递解决问题，把jQuery的原型传递给jQuery.prototype.init.prototype,因为是引用传递所以不需要担心循环引用性能的问题</p>
<h1 id="9-方法链式调用的实现"><a href="#9-方法链式调用的实现" class="headerlink" title="9. 方法链式调用的实现"></a>9. 方法链式调用的实现</h1><h2 id="1-DSL"><a href="#1-DSL" class="headerlink" title="1. DSL"></a>1. DSL</h2><blockquote>
<p>Domain Specific Language: 用于描述和解决特定领域问题的语言<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"> $(<span class="string">'input[type="button"]'</span>).eq(<span class="number">0</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    alert(<span class="string">'点击我！'</span>)</div><div class="line">&#125;).end().eq(<span class="number">1</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    $(<span class="string">'input[type="button"]:eq(0)'</span>).trigger(<span class="string">'click'</span>);</div><div class="line">&#125;).end().eq(<span class="number">2</span>).toggle(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'toggle'</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
</blockquote>
<p>这种管道风格的DSL链式代码：</p>
<ul>
<li>节约JS代码</li>
<li>所返回的都是同一个对象，提高代码效率<h2 id="2-return-this"><a href="#2-return-this" class="headerlink" title="2. return this"></a>2. return this</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> $$ = ajQuery = <span class="function"><span class="keyword">function</span>(<span class="params">selector</span>)</span>&#123;</div><div class="line">   <span class="keyword">return</span> <span class="keyword">new</span> ajQuery.fn.init(selector);</div><div class="line"> &#125;</div><div class="line"> ajQuery.fn = ajQuery.prototype = &#123;</div><div class="line">   <span class="attr">name</span>: <span class="string">'aaron'</span>,</div><div class="line">   <span class="attr">init</span>: <span class="function"><span class="keyword">function</span>(<span class="params">selector</span>)</span>&#123;</div><div class="line">     <span class="keyword">this</span>.selector = selector;</div><div class="line">     <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">   &#125;,</div><div class="line">   <span class="attr">constructor</span>: ajQuery</div><div class="line"> &#125;</div><div class="line"> ajQuery.fn.init.prototype = ajQuery.fn;</div><div class="line"> ajQuery.fn.setName = <span class="function"><span class="keyword">function</span>(<span class="params">myName</span>)</span>&#123;</div><div class="line">   <span class="keyword">this</span>.myName = myName;</div><div class="line">   <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line"> &#125;</div><div class="line"> ajQuery.fn.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">   $(<span class="string">'#aaron'</span>).html(<span class="keyword">this</span>.myName);</div><div class="line">   <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line"> &#125;</div><div class="line"> $$().setName(<span class="string">'jiangfen'</span>).getName();</div></pre></td></tr></table></figure>
</li>
</ul>
<p>如果需要链式处理，只需要在方法内部返回当前这个实例对象的this就可以了，因为返回当前实例的this,从而可以访问自己的原型。这样处理只是同步链式，除了同步链式还有异步链式。</p>
<h1 id="10-插件接口的设计"><a href="#10-插件接口的设计" class="headerlink" title="10. 插件接口的设计"></a>10. 插件接口的设计</h1><h2 id="1-jQuery插件开发分为两种"><a href="#1-jQuery插件开发分为两种" class="headerlink" title="1. jQuery插件开发分为两种"></a>1. jQuery插件开发分为两种</h2><ul>
<li>挂在jQuery命名空间下的全局函数，也可称为静态方法</li>
<li>挂在jQuery原型下的方法，这样通过选择器的jQuery对象实例也能共享该方法。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//提供的接口</span></div><div class="line">$.extend(target, [object1], [objectN])</div><div class="line"><span class="comment">//接口的使用： </span></div><div class="line">jQuery.extend(&#123;</div><div class="line">  <span class="attr">data</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</div><div class="line">  <span class="attr">removeData</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line">jQuery.fn.extend(&#123;</div><div class="line">  <span class="attr">data</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</div><div class="line">  <span class="attr">removeData</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="2-jQuery实现方法"><a href="#2-jQuery实现方法" class="headerlink" title="2. jQuery实现方法"></a>2. jQuery实现方法</h2><ul>
<li>jQuery支持自己扩展属性，jQuery.extend和jQuery.fn.extend其实是同指向同一方法的不同引用</li>
<li>jQuery.extend调用的时候上下文指向的是jQuery构造器</li>
<li>jQuery.fn.extend调用的时候上下文指向的是jQuery构造器的实例对象<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span>  $$ = ajQuery = <span class="function"><span class="keyword">function</span>(<span class="params">selector</span>)</span>&#123;</div><div class="line">   <span class="keyword">return</span> <span class="keyword">new</span> ajQuery.fn.init(selector);</div><div class="line"> &#125;</div><div class="line"> ajQuery.fn = ajQuery.prototype = &#123;</div><div class="line">   <span class="attr">name</span>: <span class="string">"aaron"</span>,</div><div class="line">   <span class="attr">init</span>: <span class="function"><span class="keyword">function</span>(<span class="params">selector</span>)</span>&#123;</div><div class="line">     <span class="keyword">this</span>.selector = selector;</div><div class="line">     <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">     &#125;,</div><div class="line">   <span class="attr">constructor</span>: ajQuery</div><div class="line"> &#125;</div><div class="line">  ajQuery.fn.init.prototype = ajQuery.fn;</div><div class="line">  ajQuery.extend = ajQuery.fn.extend = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> options, src, copy, target = <span class="built_in">arguments</span>[<span class="number">0</span>]||&#123;&#125;,i = <span class="number">1</span>, length = <span class="built_in">arguments</span>.length;</div><div class="line">    <span class="comment">//只有一个参数，就是对jQuery自身的扩展处理</span></div><div class="line">    <span class="comment">//extend,fn.extend</span></div><div class="line">    <span class="keyword">if</span>(i === length)&#123;</div><div class="line">      target = <span class="keyword">this</span>; <span class="comment">//调用的上下文对象jQuery/或者实例</span></div><div class="line">      i--;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(;i &lt; length; i++)&#123;</div><div class="line">      <span class="comment">//从i开始取参数，不为空开始遍历</span></div><div class="line">      <span class="keyword">if</span>((options = <span class="built_in">arguments</span>[i])!=<span class="literal">null</span>)&#123;</div><div class="line">        <span class="keyword">for</span>(name <span class="keyword">in</span> options)&#123;</div><div class="line">          copy = options[name];</div><div class="line">          <span class="comment">//覆盖拷贝</span></div><div class="line">          target[name] = copy;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> target;</div><div class="line">  &#125;</div><div class="line">  ajQuery.fn.extend(&#123;</div><div class="line">    <span class="attr">setName</span>: <span class="function"><span class="keyword">function</span>(<span class="params">myName</span>)</span>&#123;</div><div class="line">      <span class="keyword">this</span>.myName = myName;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">getName</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      <span class="built_in">document</span>.querySelector(<span class="string">"#aaron"</span>).innerHTML = <span class="keyword">this</span>.myName;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;)</div><div class="line">$$().setName(<span class="string">"张辉是个大傻逼"</span>).getName();</div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="11-回溯处理的设计"><a href="#11-回溯处理的设计" class="headerlink" title="11. 回溯处理的设计"></a>11. 回溯处理的设计</h1><h2 id="1-关于jQuery对象的包装"><a href="#1-关于jQuery对象的包装" class="headerlink" title="1. 关于jQuery对象的包装"></a>1. 关于jQuery对象的包装</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> $test = $(<span class="string">'test'</span>);</div></pre></td></tr></table></figure>
<p>返回jQuery对象<br><img src="/images/prevObject.jpg" alt="img">  </p>
<blockquote>
<p>jQuery内部维护着一个jQuery对象栈， 每个遍历方法都会找到一组新元素（一个jQuery对象），然后jQuery会把这组元素推入到栈中。<br>而每个jQuery对象都有三个属性： context、selector和prevObject, 其中的prevObject属性就指向这个对象栈中的前一个对象，通过这个属性可以回溯到最初的DOM元素集中。  </p>
</blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">  &lt;ul id="test"&gt;</div><div class="line">    parent</div><div class="line">    &lt;li&gt;child&lt;/li&gt;</div><div class="line">  &lt;/ul&gt;</div><div class="line"> //分开</div><div class="line"> var aa = $('#test);</div><div class="line"> test.find('li').click(function()&#123;</div><div class="line">   alert(1); //1</div><div class="line"> &#125;)</div><div class="line"> test.click(function()&#123;</div><div class="line">   alert(2)</div><div class="line"> &#125;)</div><div class="line">//链式</div><div class="line">test.find('li').click(function()&#123;</div><div class="line">  alert(1);</div><div class="line">&#125;).end().click(function()&#123;</div><div class="line">  alert(2);</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>jQuery为我们操作内部对象栈提供了非常有用的2个方法</p>
<ul>
<li>.end()<br>回到前一个jQuery对象</li>
<li>.addBack()<br>调用它会在栈中回溯一个位置，然后把两个位置上的元素组合起来，并把这个新的组合之后的元素集推入栈的上方  </li>
</ul>
<p>利用这个DOM元素栈可以减少重复的查询和遍历的操作</p>
<h1 id="11-end与addBack"><a href="#11-end与addBack" class="headerlink" title="11. end与addBack"></a>11. end与addBack</h1><h2 id="源码实现"><a href="#源码实现" class="headerlink" title="源码实现"></a>源码实现</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">end: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.prevObject || <span class="keyword">this</span>.constructor(<span class="literal">null</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">jQuery.fn.extend(&#123;</div><div class="line">  <span class="attr">find</span>: <span class="function"><span class="keyword">function</span>(<span class="params">selector</span>)</span>&#123;</div><div class="line">        jQuery.find(selector, self[i], ret);</div><div class="line">        <span class="comment">//Needed because $(selector,context)becomes $(context).find(selector)</span></div><div class="line">        ret = <span class="keyword">this</span>.pushStack(len &gt; <span class="number">1</span>? jQuery.unique(ret):ret);</div><div class="line">        ret.selector = <span class="keyword">this</span>.selector?<span class="keyword">this</span>.selector + <span class="string">" "</span> + selector: selector;</div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<blockquote>
<p>流程解析   </p>
<ol>
<li>首先构建一个新的jQuery对象，因为constructor是指向构造器的，所以这里就等同于调用jQuery()方法了，返回了一个新的jQuery对象   </li>
<li>然后用jQuery.merge语句把elems节点合并到新的jQuery对象   </li>
<li>最后给返回的新jQuery对象添加prevObject属性</li>
</ol>
</blockquote>
<h1 id="12-仿栈与队列的操作"><a href="#12-仿栈与队列的操作" class="headerlink" title="12. 仿栈与队列的操作"></a>12. 仿栈与队列的操作</h1><h2 id="1-get方法"><a href="#1-get方法" class="headerlink" title="1. get方法"></a>1. get方法</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">get: <span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> num != <span class="literal">null</span>?<span class="comment">//Return just the one element from the set</span></div><div class="line">  (num &lt; <span class="number">0</span> ? <span class="keyword">this</span>[num + <span class="keyword">this</span>.length]):<span class="keyword">this</span>[num]<span class="comment">//Return all the elements in a clean array</span></div><div class="line">  slice.call(<span class="keyword">this</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>坚持原创技术分享，您的支持将鼓励我继续创作!</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="/images/wechat.jpg" alt="Jiang Fen WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
    </div>
  </div>


      
    </div>


    <footer class="post-footer">
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/11/07/animation/" rel="prev" title="animation">
                animation <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2017/06/04/learnJquery/"
           data-title="learnJquery" data-url="http://www.ceerqingting.com/2017/06/04/learnJquery/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.png"
               alt="Jiang Fen" />
          <p class="site-author-name" itemprop="name">Jiang Fen</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/ceerqingting" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/5707883973" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-jQuery整体架构"><span class="nav-number">1.</span> <span class="nav-text">1. jQuery整体架构</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-五大块"><span class="nav-number">1.1.</span> <span class="nav-text">1. 五大块</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-示例"><span class="nav-number">1.2.</span> <span class="nav-text">2. 示例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-jQuery接口设计原理"><span class="nav-number">1.3.</span> <span class="nav-text">3. jQuery接口设计原理</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-立即调用表达式"><span class="nav-number">2.</span> <span class="nav-text">2. 立即调用表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-写法"><span class="nav-number">2.1.</span> <span class="nav-text">1. 写法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-写法优势"><span class="nav-number">2.2.</span> <span class="nav-text">2. 写法优势</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-为什么要传递undefined"><span class="nav-number">2.3.</span> <span class="nav-text">3. 为什么要传递undefined</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-为什么要创建一个外层包裹"><span class="nav-number">2.4.</span> <span class="nav-text">4. 为什么要创建一个外层包裹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-总结"><span class="nav-number">2.5.</span> <span class="nav-text">5. 总结</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-jQuery的类数组对象结构"><span class="nav-number">3.</span> <span class="nav-text">3. jQuery的类数组对象结构</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-为什么是类数组对象呢？"><span class="nav-number">3.1.</span> <span class="nav-text">1. 为什么是类数组对象呢？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-jQuery对象可用数组下标索引是什么原理"><span class="nav-number">3.2.</span> <span class="nav-text">2. jQuery对象可用数组下标索引是什么原理?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-jQuery的无new构建原理"><span class="nav-number">3.3.</span> <span class="nav-text">3. jQuery的无new构建原理</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-jQuery中的ready与load事件"><span class="nav-number">4.</span> <span class="nav-text">4. jQuery中的ready与load事件</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-jQuery3种针对文档加载的方法"><span class="nav-number">4.1.</span> <span class="nav-text">1. jQuery3种针对文档加载的方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-ready和load区别"><span class="nav-number">4.2.</span> <span class="nav-text">2. ready和load区别</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-jQuery多库共存处理"><span class="nav-number">5.</span> <span class="nav-text">5. jQuery多库共存处理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-使用DEMO"><span class="nav-number">5.1.</span> <span class="nav-text">1. 使用DEMO</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-原理"><span class="nav-number">5.2.</span> <span class="nav-text">2. 原理</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-对象的构建"><span class="nav-number">6.</span> <span class="nav-text">6. 对象的构建</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-分离构造器"><span class="nav-number">7.</span> <span class="nav-text">7. 分离构造器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-通过new操作符构建一个对象："><span class="nav-number">7.1.</span> <span class="nav-text">1. 通过new操作符构建一个对象：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8-静态与实例方法共享设计"><span class="nav-number">8.</span> <span class="nav-text">8. 静态与实例方法共享设计</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-遍历方法"><span class="nav-number">8.1.</span> <span class="nav-text">1. 遍历方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-共享方法"><span class="nav-number">8.2.</span> <span class="nav-text">2. 共享方法</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9-方法链式调用的实现"><span class="nav-number">9.</span> <span class="nav-text">9. 方法链式调用的实现</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-DSL"><span class="nav-number">9.1.</span> <span class="nav-text">1. DSL</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-return-this"><span class="nav-number">9.2.</span> <span class="nav-text">2. return this</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#10-插件接口的设计"><span class="nav-number">10.</span> <span class="nav-text">10. 插件接口的设计</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-jQuery插件开发分为两种"><span class="nav-number">10.1.</span> <span class="nav-text">1. jQuery插件开发分为两种</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-jQuery实现方法"><span class="nav-number">10.2.</span> <span class="nav-text">2. jQuery实现方法</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#11-回溯处理的设计"><span class="nav-number">11.</span> <span class="nav-text">11. 回溯处理的设计</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-关于jQuery对象的包装"><span class="nav-number">11.1.</span> <span class="nav-text">1. 关于jQuery对象的包装</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#11-end与addBack"><span class="nav-number">12.</span> <span class="nav-text">11. end与addBack</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#源码实现"><span class="nav-number">12.1.</span> <span class="nav-text">源码实现</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#12-仿栈与队列的操作"><span class="nav-number">13.</span> <span class="nav-text">12. 仿栈与队列的操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-get方法"><span class="nav-number">13.1.</span> <span class="nav-text">1. get方法</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jiang Fen</span>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"jiangfen"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  













  
  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("wSAzwnspShWjdu2xY2WXV8zB-gzGzoHsz", "I49MawzOtPFjXLoxEva0Chj5");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.0"></script>



  

</body>
</html>
